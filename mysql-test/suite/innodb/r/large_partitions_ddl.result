#
# Bug#31365127 DROP A PARTITION RESULT IN OOM
#
set global innodb_file_per_table = off;
CREATE TABLE t1(a INT NOT NULL, PRIMARY KEY(a)) ENGINE=INNODB
PARTITION BY HASH(a) PARTITIONS 1024;
DROP TABLE t1;
set global innodb_file_per_table = off;
CREATE TABLE t1(a INT NOT NULL, PRIMARY KEY(a)) ENGINE=INNODB
PARTITION BY HASH(a) PARTITIONS 1024;
RENAME TABLE t1 TO t2;
DROP TABLE t2;
set global innodb_file_per_table = off;
CREATE TABLE t1(a INT NOT NULL, PRIMARY KEY(a)) ENGINE=INNODB
PARTITION BY HASH(a) PARTITIONS 1024;
TRUNCATE TABLE t1;
DROP TABLE t1;
set global innodb_file_per_table = on;
CREATE TABLE t1(a INT NOT NULL, PRIMARY KEY(a)) ENGINE=INNODB
PARTITION BY HASH(a) PARTITIONS 1024;
DROP TABLE t1;
CREATE TABLE t1(a INT NOT NULL, PRIMARY KEY(a)) ENGINE=INNODB
PARTITION BY HASH(a) PARTITIONS 1024;
RENAME TABLE t1 TO t2;
DROP TABLE t2;
CREATE TABLE t1(a INT NOT NULL, PRIMARY KEY(a)) ENGINE=INNODB
PARTITION BY HASH(a) PARTITIONS 1024;
TRUNCATE TABLE t1;
DROP TABLE t1;
