create table t1 (kbu bigint unsigned,
kbs bigint,
dbu_low bigint unsigned,
dbu_hi bigint unsigned,
dbs_low bigint,
dbs_hi bigint,
d int,
t text,
primary key(kbu, kbs))
engine = ndb;
insert into t1 values 
(10, 10, 0, 18446744073709551606, -9223372036854775808, 9223372036854775798, 10, repeat("10", 1000)),
(11, 11, 1, 18446744073709551607, -9223372036854775807, 9223372036854775799, 11, repeat("11", 1000)),
(12, 12, 2, 18446744073709551608, -9223372036854775806, 9223372036854775800, 12, repeat("12", 1000)),
(13, 13, 3, 18446744073709551609, -9223372036854775805, 9223372036854775801, 13, repeat("13", 1000)),
(14, 14, 4, 18446744073709551610, -9223372036854775804, 9223372036854775802, 14, repeat("14", 1000)),
(15, 15, 5, 18446744073709551611, -9223372036854775803, 9223372036854775803, 15, repeat("15", 1000)),
(16, 16, 6, 18446744073709551612, -9223372036854775802, 9223372036854775804, 16, repeat("16", 1000)),
(17, 17, 7, 18446744073709551613, -9223372036854775801, 9223372036854775805, 17, repeat("17", 1000)),
(18, 18, 8, 18446744073709551614, -9223372036854775800, 9223372036854775806, 18, repeat("18", 1000)),
(19, 19, 9, 18446744073709551615, -9223372036854775799, 9223372036854775807, 19, repeat("19", 1000));
select kbu, kbs, dbu_low, dbu_hi, dbs_low, dbs_hi, d, sha1(t) from test.t1 order by kbu;
kbu	kbs	dbu_low	dbu_hi	dbs_low	dbs_hi	d	sha1(t)
10	10	0	18446744073709551606	-9223372036854775808	9223372036854775798	10	1746a73fbc27d76ffc2e7b503da9a5ecf97654fc
11	11	1	18446744073709551607	-9223372036854775807	9223372036854775799	11	a2c68c4b2bd3c6496dbb950de07549b99f586464
12	12	2	18446744073709551608	-9223372036854775806	9223372036854775800	12	8f03472cce5280aba1d0a4f1bf42b984f063dfc6
13	13	3	18446744073709551609	-9223372036854775805	9223372036854775801	13	81a05d079148374cc1ac5d995c36d3db005a7b1f
14	14	4	18446744073709551610	-9223372036854775804	9223372036854775802	14	816a88c32835139a3c1b8362020241a7d03c1768
15	15	5	18446744073709551611	-9223372036854775803	9223372036854775803	15	66e995d4929bcd5d21e7ad0e00b8203ddba9c9c4
16	16	6	18446744073709551612	-9223372036854775802	9223372036854775804	16	2f783ca2ead824631f7b729cfcf1cf22748aa2b7
17	17	7	18446744073709551613	-9223372036854775801	9223372036854775805	17	9fe20fbc5f880a060075656835cdf38e2b2cefcd
18	18	8	18446744073709551614	-9223372036854775800	9223372036854775806	18	c8abcc9e265f63f0fe47931bfeb1328e57a6e848
19	19	9	18446744073709551615	-9223372036854775799	9223372036854775807	19	c36cdf290b4883026e80a0aa4b9156c763ae2a8f
Create a table with NULL-value columns
create table t2(
col1 int unsigned not null primary key,
col2 int unsigned DEFAULT NULL)
charset = utf8mb4 engine=ndbcluster;
insert into t2 values(1, 1), (2,2), (3,NULL), (4,4), (5,5);
Run backup
Restore with no key offsets + 0 + 0
Remapping a column having NULL values with an offset.
NULL values will be preserved.
truncate test.t1;
truncate table t2;
select kbu, kbs, dbu_low, dbu_hi, dbs_low, dbs_hi, d, sha1(t) from test.t1 order by kbu;
kbu	kbs	dbu_low	dbu_hi	dbs_low	dbs_hi	d	sha1(t)
10	10	0	18446744073709551606	-9223372036854775808	9223372036854775798	10	1746a73fbc27d76ffc2e7b503da9a5ecf97654fc
11	11	1	18446744073709551607	-9223372036854775807	9223372036854775799	11	a2c68c4b2bd3c6496dbb950de07549b99f586464
12	12	2	18446744073709551608	-9223372036854775806	9223372036854775800	12	8f03472cce5280aba1d0a4f1bf42b984f063dfc6
13	13	3	18446744073709551609	-9223372036854775805	9223372036854775801	13	81a05d079148374cc1ac5d995c36d3db005a7b1f
14	14	4	18446744073709551610	-9223372036854775804	9223372036854775802	14	816a88c32835139a3c1b8362020241a7d03c1768
15	15	5	18446744073709551611	-9223372036854775803	9223372036854775803	15	66e995d4929bcd5d21e7ad0e00b8203ddba9c9c4
16	16	6	18446744073709551612	-9223372036854775802	9223372036854775804	16	2f783ca2ead824631f7b729cfcf1cf22748aa2b7
17	17	7	18446744073709551613	-9223372036854775801	9223372036854775805	17	9fe20fbc5f880a060075656835cdf38e2b2cefcd
18	18	8	18446744073709551614	-9223372036854775800	9223372036854775806	18	c8abcc9e265f63f0fe47931bfeb1328e57a6e848
19	19	9	18446744073709551615	-9223372036854775799	9223372036854775807	19	c36cdf290b4883026e80a0aa4b9156c763ae2a8f
select * from t2 order by col1;
col1	col2
1	11
2	12
3	NULL
4	14
5	15
Restore with small overlapping key offset + 5
truncate test.t1;
select kbu, kbs, dbu_low, dbu_hi, dbs_low, dbs_hi, d, sha1(t) from test.t1 order by kbu;
kbu	kbs	dbu_low	dbu_hi	dbs_low	dbs_hi	d	sha1(t)
15	15	0	18446744073709551606	-9223372036854775808	9223372036854775798	10	1746a73fbc27d76ffc2e7b503da9a5ecf97654fc
16	16	1	18446744073709551607	-9223372036854775807	9223372036854775799	11	a2c68c4b2bd3c6496dbb950de07549b99f586464
17	17	2	18446744073709551608	-9223372036854775806	9223372036854775800	12	8f03472cce5280aba1d0a4f1bf42b984f063dfc6
18	18	3	18446744073709551609	-9223372036854775805	9223372036854775801	13	81a05d079148374cc1ac5d995c36d3db005a7b1f
19	19	4	18446744073709551610	-9223372036854775804	9223372036854775802	14	816a88c32835139a3c1b8362020241a7d03c1768
20	20	5	18446744073709551611	-9223372036854775803	9223372036854775803	15	66e995d4929bcd5d21e7ad0e00b8203ddba9c9c4
21	21	6	18446744073709551612	-9223372036854775802	9223372036854775804	16	2f783ca2ead824631f7b729cfcf1cf22748aa2b7
22	22	7	18446744073709551613	-9223372036854775801	9223372036854775805	17	9fe20fbc5f880a060075656835cdf38e2b2cefcd
23	23	8	18446744073709551614	-9223372036854775800	9223372036854775806	18	c8abcc9e265f63f0fe47931bfeb1328e57a6e848
24	24	9	18446744073709551615	-9223372036854775799	9223372036854775807	19	c36cdf290b4883026e80a0aa4b9156c763ae2a8f
Restore with larger gap key offset + 20
truncate test.t1;
select kbu, kbs, dbu_low, dbu_hi, dbs_low, dbs_hi, d, sha1(t) from test.t1 order by kbu;
kbu	kbs	dbu_low	dbu_hi	dbs_low	dbs_hi	d	sha1(t)
30	30	0	18446744073709551606	-9223372036854775808	9223372036854775798	10	1746a73fbc27d76ffc2e7b503da9a5ecf97654fc
31	31	1	18446744073709551607	-9223372036854775807	9223372036854775799	11	a2c68c4b2bd3c6496dbb950de07549b99f586464
32	32	2	18446744073709551608	-9223372036854775806	9223372036854775800	12	8f03472cce5280aba1d0a4f1bf42b984f063dfc6
33	33	3	18446744073709551609	-9223372036854775805	9223372036854775801	13	81a05d079148374cc1ac5d995c36d3db005a7b1f
34	34	4	18446744073709551610	-9223372036854775804	9223372036854775802	14	816a88c32835139a3c1b8362020241a7d03c1768
35	35	5	18446744073709551611	-9223372036854775803	9223372036854775803	15	66e995d4929bcd5d21e7ad0e00b8203ddba9c9c4
36	36	6	18446744073709551612	-9223372036854775802	9223372036854775804	16	2f783ca2ead824631f7b729cfcf1cf22748aa2b7
37	37	7	18446744073709551613	-9223372036854775801	9223372036854775805	17	9fe20fbc5f880a060075656835cdf38e2b2cefcd
38	38	8	18446744073709551614	-9223372036854775800	9223372036854775806	18	c8abcc9e265f63f0fe47931bfeb1328e57a6e848
39	39	9	18446744073709551615	-9223372036854775799	9223372036854775807	19	c36cdf290b4883026e80a0aa4b9156c763ae2a8f
Restore with low data values + max offset (9223372036854775807)
truncate test.t1;
select kbu, kbs, dbu_low, dbu_hi, dbs_low, dbs_hi, d, sha1(t) from test.t1 order by kbu;
kbu	kbs	dbu_low	dbu_hi	dbs_low	dbs_hi	d	sha1(t)
10	10	9223372036854775807	18446744073709551606	-1	9223372036854775798	10	1746a73fbc27d76ffc2e7b503da9a5ecf97654fc
11	11	9223372036854775808	18446744073709551607	0	9223372036854775799	11	a2c68c4b2bd3c6496dbb950de07549b99f586464
12	12	9223372036854775809	18446744073709551608	1	9223372036854775800	12	8f03472cce5280aba1d0a4f1bf42b984f063dfc6
13	13	9223372036854775810	18446744073709551609	2	9223372036854775801	13	81a05d079148374cc1ac5d995c36d3db005a7b1f
14	14	9223372036854775811	18446744073709551610	3	9223372036854775802	14	816a88c32835139a3c1b8362020241a7d03c1768
15	15	9223372036854775812	18446744073709551611	4	9223372036854775803	15	66e995d4929bcd5d21e7ad0e00b8203ddba9c9c4
16	16	9223372036854775813	18446744073709551612	5	9223372036854775804	16	2f783ca2ead824631f7b729cfcf1cf22748aa2b7
17	17	9223372036854775814	18446744073709551613	6	9223372036854775805	17	9fe20fbc5f880a060075656835cdf38e2b2cefcd
18	18	9223372036854775815	18446744073709551614	7	9223372036854775806	18	c8abcc9e265f63f0fe47931bfeb1328e57a6e848
19	19	9223372036854775816	18446744073709551615	8	9223372036854775807	19	c36cdf290b4883026e80a0aa4b9156c763ae2a8f
Restore with key offset + 30 and low data offset + 110
truncate test.t1;
select kbu, kbs, dbu_low, dbu_hi, dbs_low, dbs_hi, d, sha1(t) from test.t1 order by kbu;
kbu	kbs	dbu_low	dbu_hi	dbs_low	dbs_hi	d	sha1(t)
40	40	110	18446744073709551606	-9223372036854775698	9223372036854775798	10	1746a73fbc27d76ffc2e7b503da9a5ecf97654fc
41	41	111	18446744073709551607	-9223372036854775697	9223372036854775799	11	a2c68c4b2bd3c6496dbb950de07549b99f586464
42	42	112	18446744073709551608	-9223372036854775696	9223372036854775800	12	8f03472cce5280aba1d0a4f1bf42b984f063dfc6
43	43	113	18446744073709551609	-9223372036854775695	9223372036854775801	13	81a05d079148374cc1ac5d995c36d3db005a7b1f
44	44	114	18446744073709551610	-9223372036854775694	9223372036854775802	14	816a88c32835139a3c1b8362020241a7d03c1768
45	45	115	18446744073709551611	-9223372036854775693	9223372036854775803	15	66e995d4929bcd5d21e7ad0e00b8203ddba9c9c4
46	46	116	18446744073709551612	-9223372036854775692	9223372036854775804	16	2f783ca2ead824631f7b729cfcf1cf22748aa2b7
47	47	117	18446744073709551613	-9223372036854775691	9223372036854775805	17	9fe20fbc5f880a060075656835cdf38e2b2cefcd
48	48	118	18446744073709551614	-9223372036854775690	9223372036854775806	18	c8abcc9e265f63f0fe47931bfeb1328e57a6e848
49	49	119	18446744073709551615	-9223372036854775689	9223372036854775807	19	c36cdf290b4883026e80a0aa4b9156c763ae2a8f
Restore with high data values - max offset (-9223372036854775808)
truncate test.t1;
select kbu, kbs, dbu_low, dbu_hi, dbs_low, dbs_hi, d, sha1(t) from test.t1 order by kbu;
kbu	kbs	dbu_low	dbu_hi	dbs_low	dbs_hi	d	sha1(t)
10	10	0	9223372036854775798	-9223372036854775808	-10	10	1746a73fbc27d76ffc2e7b503da9a5ecf97654fc
11	11	1	9223372036854775799	-9223372036854775807	-9	11	a2c68c4b2bd3c6496dbb950de07549b99f586464
12	12	2	9223372036854775800	-9223372036854775806	-8	12	8f03472cce5280aba1d0a4f1bf42b984f063dfc6
13	13	3	9223372036854775801	-9223372036854775805	-7	13	81a05d079148374cc1ac5d995c36d3db005a7b1f
14	14	4	9223372036854775802	-9223372036854775804	-6	14	816a88c32835139a3c1b8362020241a7d03c1768
15	15	5	9223372036854775803	-9223372036854775803	-5	15	66e995d4929bcd5d21e7ad0e00b8203ddba9c9c4
16	16	6	9223372036854775804	-9223372036854775802	-4	16	2f783ca2ead824631f7b729cfcf1cf22748aa2b7
17	17	7	9223372036854775805	-9223372036854775801	-3	17	9fe20fbc5f880a060075656835cdf38e2b2cefcd
18	18	8	9223372036854775806	-9223372036854775800	-2	18	c8abcc9e265f63f0fe47931bfeb1328e57a6e848
19	19	9	9223372036854775807	-9223372036854775799	-1	19	c36cdf290b4883026e80a0aa4b9156c763ae2a8f
Restore with key offset - 10
truncate test.t1;
select kbu, kbs, dbu_low, dbu_hi, dbs_low, dbs_hi, d, sha1(t) from test.t1 order by kbu;
kbu	kbs	dbu_low	dbu_hi	dbs_low	dbs_hi	d	sha1(t)
0	0	0	18446744073709551606	-9223372036854775808	9223372036854775798	10	1746a73fbc27d76ffc2e7b503da9a5ecf97654fc
1	1	1	18446744073709551607	-9223372036854775807	9223372036854775799	11	a2c68c4b2bd3c6496dbb950de07549b99f586464
2	2	2	18446744073709551608	-9223372036854775806	9223372036854775800	12	8f03472cce5280aba1d0a4f1bf42b984f063dfc6
3	3	3	18446744073709551609	-9223372036854775805	9223372036854775801	13	81a05d079148374cc1ac5d995c36d3db005a7b1f
4	4	4	18446744073709551610	-9223372036854775804	9223372036854775802	14	816a88c32835139a3c1b8362020241a7d03c1768
5	5	5	18446744073709551611	-9223372036854775803	9223372036854775803	15	66e995d4929bcd5d21e7ad0e00b8203ddba9c9c4
6	6	6	18446744073709551612	-9223372036854775802	9223372036854775804	16	2f783ca2ead824631f7b729cfcf1cf22748aa2b7
7	7	7	18446744073709551613	-9223372036854775801	9223372036854775805	17	9fe20fbc5f880a060075656835cdf38e2b2cefcd
8	8	8	18446744073709551614	-9223372036854775800	9223372036854775806	18	c8abcc9e265f63f0fe47931bfeb1328e57a6e848
9	9	9	18446744073709551615	-9223372036854775799	9223372036854775807	19	c36cdf290b4883026e80a0aa4b9156c763ae2a8f
Restore with max positive key offset kbu + 9223372036854775807 kbs + 9223372036854775807-19
truncate test.t1;
select kbu, kbs, dbu_low, dbu_hi, dbs_low, dbs_hi, d, sha1(t) from test.t1 order by kbu;
kbu	kbs	dbu_low	dbu_hi	dbs_low	dbs_hi	d	sha1(t)
9223372036854775817	9223372036854775798	0	18446744073709551606	-9223372036854775808	9223372036854775798	10	1746a73fbc27d76ffc2e7b503da9a5ecf97654fc
9223372036854775818	9223372036854775799	1	18446744073709551607	-9223372036854775807	9223372036854775799	11	a2c68c4b2bd3c6496dbb950de07549b99f586464
9223372036854775819	9223372036854775800	2	18446744073709551608	-9223372036854775806	9223372036854775800	12	8f03472cce5280aba1d0a4f1bf42b984f063dfc6
9223372036854775820	9223372036854775801	3	18446744073709551609	-9223372036854775805	9223372036854775801	13	81a05d079148374cc1ac5d995c36d3db005a7b1f
9223372036854775821	9223372036854775802	4	18446744073709551610	-9223372036854775804	9223372036854775802	14	816a88c32835139a3c1b8362020241a7d03c1768
9223372036854775822	9223372036854775803	5	18446744073709551611	-9223372036854775803	9223372036854775803	15	66e995d4929bcd5d21e7ad0e00b8203ddba9c9c4
9223372036854775823	9223372036854775804	6	18446744073709551612	-9223372036854775802	9223372036854775804	16	2f783ca2ead824631f7b729cfcf1cf22748aa2b7
9223372036854775824	9223372036854775805	7	18446744073709551613	-9223372036854775801	9223372036854775805	17	9fe20fbc5f880a060075656835cdf38e2b2cefcd
9223372036854775825	9223372036854775806	8	18446744073709551614	-9223372036854775800	9223372036854775806	18	c8abcc9e265f63f0fe47931bfeb1328e57a6e848
9223372036854775826	9223372036854775807	9	18446744073709551615	-9223372036854775799	9223372036854775807	19	c36cdf290b4883026e80a0aa4b9156c763ae2a8f
Restore with max negative key offset kbu -10 kbs -9223372036854775808
truncate test.t1;
select kbu, kbs, dbu_low, dbu_hi, dbs_low, dbs_hi, d, sha1(t) from test.t1 order by kbu;
kbu	kbs	dbu_low	dbu_hi	dbs_low	dbs_hi	d	sha1(t)
0	-9223372036854775798	0	18446744073709551606	-9223372036854775808	9223372036854775798	10	1746a73fbc27d76ffc2e7b503da9a5ecf97654fc
1	-9223372036854775797	1	18446744073709551607	-9223372036854775807	9223372036854775799	11	a2c68c4b2bd3c6496dbb950de07549b99f586464
2	-9223372036854775796	2	18446744073709551608	-9223372036854775806	9223372036854775800	12	8f03472cce5280aba1d0a4f1bf42b984f063dfc6
3	-9223372036854775795	3	18446744073709551609	-9223372036854775805	9223372036854775801	13	81a05d079148374cc1ac5d995c36d3db005a7b1f
4	-9223372036854775794	4	18446744073709551610	-9223372036854775804	9223372036854775802	14	816a88c32835139a3c1b8362020241a7d03c1768
5	-9223372036854775793	5	18446744073709551611	-9223372036854775803	9223372036854775803	15	66e995d4929bcd5d21e7ad0e00b8203ddba9c9c4
6	-9223372036854775792	6	18446744073709551612	-9223372036854775802	9223372036854775804	16	2f783ca2ead824631f7b729cfcf1cf22748aa2b7
7	-9223372036854775791	7	18446744073709551613	-9223372036854775801	9223372036854775805	17	9fe20fbc5f880a060075656835cdf38e2b2cefcd
8	-9223372036854775790	8	18446744073709551614	-9223372036854775800	9223372036854775806	18	c8abcc9e265f63f0fe47931bfeb1328e57a6e848
9	-9223372036854775789	9	18446744073709551615	-9223372036854775799	9223372036854775807	19	c36cdf290b4883026e80a0aa4b9156c763ae2a8f
drop table test.t1;
drop table test.t2;
create table t1 (kiu int unsigned,
kis int,
diu_low int unsigned,
diu_hi int unsigned,
dis_low int,
dis_hi int,
d int,
t text,
primary key(kiu, kis))
engine = ndb;
insert into t1 values 
(10, 10, 0, 4294967286, -2147483648, 2147483638, 10, repeat("10", 1000)),
(11, 11, 1, 4294967287, -2147483647, 2147483639, 11, repeat("11", 1000)),
(12, 12, 2, 4294967288, -2147483646, 2147483640, 12, repeat("12", 1000)),
(13, 13, 3, 4294967289, -2147483645, 2147483641, 13, repeat("13", 1000)),
(14, 14, 4, 4294967290, -2147483644, 2147483642, 14, repeat("14", 1000)),
(15, 15, 5, 4294967291, -2147483643, 2147483643, 15, repeat("15", 1000)),
(16, 16, 6, 4294967292, -2147483642, 2147483644, 16, repeat("16", 1000)),
(17, 17, 7, 4294967293, -2147483641, 2147483645, 17, repeat("17", 1000)),
(18, 18, 8, 4294967294, -2147483640, 2147483646, 18, repeat("18", 1000)),
(19, 19, 9, 4294967295, -2147483639, 2147483647, 19, repeat("19", 1000));
select kiu, kis, diu_low, diu_hi, dis_low, dis_hi, d, sha1(t) from test.t1 order by kiu;
kiu	kis	diu_low	diu_hi	dis_low	dis_hi	d	sha1(t)
10	10	0	4294967286	-2147483648	2147483638	10	1746a73fbc27d76ffc2e7b503da9a5ecf97654fc
11	11	1	4294967287	-2147483647	2147483639	11	a2c68c4b2bd3c6496dbb950de07549b99f586464
12	12	2	4294967288	-2147483646	2147483640	12	8f03472cce5280aba1d0a4f1bf42b984f063dfc6
13	13	3	4294967289	-2147483645	2147483641	13	81a05d079148374cc1ac5d995c36d3db005a7b1f
14	14	4	4294967290	-2147483644	2147483642	14	816a88c32835139a3c1b8362020241a7d03c1768
15	15	5	4294967291	-2147483643	2147483643	15	66e995d4929bcd5d21e7ad0e00b8203ddba9c9c4
16	16	6	4294967292	-2147483642	2147483644	16	2f783ca2ead824631f7b729cfcf1cf22748aa2b7
17	17	7	4294967293	-2147483641	2147483645	17	9fe20fbc5f880a060075656835cdf38e2b2cefcd
18	18	8	4294967294	-2147483640	2147483646	18	c8abcc9e265f63f0fe47931bfeb1328e57a6e848
19	19	9	4294967295	-2147483639	2147483647	19	c36cdf290b4883026e80a0aa4b9156c763ae2a8f
Run backup
Restore with no key offsets + 0 + 0
truncate test.t1;
select kiu, kis, diu_low, diu_hi, dis_low, dis_hi, d, sha1(t) from test.t1 order by kiu;
kiu	kis	diu_low	diu_hi	dis_low	dis_hi	d	sha1(t)
10	10	0	4294967286	-2147483648	2147483638	10	1746a73fbc27d76ffc2e7b503da9a5ecf97654fc
11	11	1	4294967287	-2147483647	2147483639	11	a2c68c4b2bd3c6496dbb950de07549b99f586464
12	12	2	4294967288	-2147483646	2147483640	12	8f03472cce5280aba1d0a4f1bf42b984f063dfc6
13	13	3	4294967289	-2147483645	2147483641	13	81a05d079148374cc1ac5d995c36d3db005a7b1f
14	14	4	4294967290	-2147483644	2147483642	14	816a88c32835139a3c1b8362020241a7d03c1768
15	15	5	4294967291	-2147483643	2147483643	15	66e995d4929bcd5d21e7ad0e00b8203ddba9c9c4
16	16	6	4294967292	-2147483642	2147483644	16	2f783ca2ead824631f7b729cfcf1cf22748aa2b7
17	17	7	4294967293	-2147483641	2147483645	17	9fe20fbc5f880a060075656835cdf38e2b2cefcd
18	18	8	4294967294	-2147483640	2147483646	18	c8abcc9e265f63f0fe47931bfeb1328e57a6e848
19	19	9	4294967295	-2147483639	2147483647	19	c36cdf290b4883026e80a0aa4b9156c763ae2a8f
Restore with small overlapping key offset + 5
truncate test.t1;
select kiu, kis, diu_low, diu_hi, dis_low, dis_hi, d, sha1(t) from test.t1 order by kiu;
kiu	kis	diu_low	diu_hi	dis_low	dis_hi	d	sha1(t)
15	15	0	4294967286	-2147483648	2147483638	10	1746a73fbc27d76ffc2e7b503da9a5ecf97654fc
16	16	1	4294967287	-2147483647	2147483639	11	a2c68c4b2bd3c6496dbb950de07549b99f586464
17	17	2	4294967288	-2147483646	2147483640	12	8f03472cce5280aba1d0a4f1bf42b984f063dfc6
18	18	3	4294967289	-2147483645	2147483641	13	81a05d079148374cc1ac5d995c36d3db005a7b1f
19	19	4	4294967290	-2147483644	2147483642	14	816a88c32835139a3c1b8362020241a7d03c1768
20	20	5	4294967291	-2147483643	2147483643	15	66e995d4929bcd5d21e7ad0e00b8203ddba9c9c4
21	21	6	4294967292	-2147483642	2147483644	16	2f783ca2ead824631f7b729cfcf1cf22748aa2b7
22	22	7	4294967293	-2147483641	2147483645	17	9fe20fbc5f880a060075656835cdf38e2b2cefcd
23	23	8	4294967294	-2147483640	2147483646	18	c8abcc9e265f63f0fe47931bfeb1328e57a6e848
24	24	9	4294967295	-2147483639	2147483647	19	c36cdf290b4883026e80a0aa4b9156c763ae2a8f
Restore with larger gap key offset + 20
truncate test.t1;
select kiu, kis, diu_low, diu_hi, dis_low, dis_hi, d, sha1(t) from test.t1 order by kiu;
kiu	kis	diu_low	diu_hi	dis_low	dis_hi	d	sha1(t)
30	30	0	4294967286	-2147483648	2147483638	10	1746a73fbc27d76ffc2e7b503da9a5ecf97654fc
31	31	1	4294967287	-2147483647	2147483639	11	a2c68c4b2bd3c6496dbb950de07549b99f586464
32	32	2	4294967288	-2147483646	2147483640	12	8f03472cce5280aba1d0a4f1bf42b984f063dfc6
33	33	3	4294967289	-2147483645	2147483641	13	81a05d079148374cc1ac5d995c36d3db005a7b1f
34	34	4	4294967290	-2147483644	2147483642	14	816a88c32835139a3c1b8362020241a7d03c1768
35	35	5	4294967291	-2147483643	2147483643	15	66e995d4929bcd5d21e7ad0e00b8203ddba9c9c4
36	36	6	4294967292	-2147483642	2147483644	16	2f783ca2ead824631f7b729cfcf1cf22748aa2b7
37	37	7	4294967293	-2147483641	2147483645	17	9fe20fbc5f880a060075656835cdf38e2b2cefcd
38	38	8	4294967294	-2147483640	2147483646	18	c8abcc9e265f63f0fe47931bfeb1328e57a6e848
39	39	9	4294967295	-2147483639	2147483647	19	c36cdf290b4883026e80a0aa4b9156c763ae2a8f
Restore with low data values + max offset (2147483647)
truncate test.t1;
select kiu, kis, diu_low, diu_hi, dis_low, dis_hi, d, sha1(t) from test.t1 order by kiu;
kiu	kis	diu_low	diu_hi	dis_low	dis_hi	d	sha1(t)
10	10	2147483647	4294967286	-1	2147483638	10	1746a73fbc27d76ffc2e7b503da9a5ecf97654fc
11	11	2147483648	4294967287	0	2147483639	11	a2c68c4b2bd3c6496dbb950de07549b99f586464
12	12	2147483649	4294967288	1	2147483640	12	8f03472cce5280aba1d0a4f1bf42b984f063dfc6
13	13	2147483650	4294967289	2	2147483641	13	81a05d079148374cc1ac5d995c36d3db005a7b1f
14	14	2147483651	4294967290	3	2147483642	14	816a88c32835139a3c1b8362020241a7d03c1768
15	15	2147483652	4294967291	4	2147483643	15	66e995d4929bcd5d21e7ad0e00b8203ddba9c9c4
16	16	2147483653	4294967292	5	2147483644	16	2f783ca2ead824631f7b729cfcf1cf22748aa2b7
17	17	2147483654	4294967293	6	2147483645	17	9fe20fbc5f880a060075656835cdf38e2b2cefcd
18	18	2147483655	4294967294	7	2147483646	18	c8abcc9e265f63f0fe47931bfeb1328e57a6e848
19	19	2147483656	4294967295	8	2147483647	19	c36cdf290b4883026e80a0aa4b9156c763ae2a8f
Restore with key offset + 30 and low data offset + 110
truncate test.t1;
select kiu, kis, diu_low, diu_hi, dis_low, dis_hi, d, sha1(t) from test.t1 order by kiu;
kiu	kis	diu_low	diu_hi	dis_low	dis_hi	d	sha1(t)
40	40	110	4294967286	-2147483538	2147483638	10	1746a73fbc27d76ffc2e7b503da9a5ecf97654fc
41	41	111	4294967287	-2147483537	2147483639	11	a2c68c4b2bd3c6496dbb950de07549b99f586464
42	42	112	4294967288	-2147483536	2147483640	12	8f03472cce5280aba1d0a4f1bf42b984f063dfc6
43	43	113	4294967289	-2147483535	2147483641	13	81a05d079148374cc1ac5d995c36d3db005a7b1f
44	44	114	4294967290	-2147483534	2147483642	14	816a88c32835139a3c1b8362020241a7d03c1768
45	45	115	4294967291	-2147483533	2147483643	15	66e995d4929bcd5d21e7ad0e00b8203ddba9c9c4
46	46	116	4294967292	-2147483532	2147483644	16	2f783ca2ead824631f7b729cfcf1cf22748aa2b7
47	47	117	4294967293	-2147483531	2147483645	17	9fe20fbc5f880a060075656835cdf38e2b2cefcd
48	48	118	4294967294	-2147483530	2147483646	18	c8abcc9e265f63f0fe47931bfeb1328e57a6e848
49	49	119	4294967295	-2147483529	2147483647	19	c36cdf290b4883026e80a0aa4b9156c763ae2a8f
Restore with high data values - max offset (-2147483648)
truncate test.t1;
select kiu, kis, diu_low, diu_hi, dis_low, dis_hi, d, sha1(t) from test.t1 order by kiu;
kiu	kis	diu_low	diu_hi	dis_low	dis_hi	d	sha1(t)
10	10	0	2147483638	-2147483648	-10	10	1746a73fbc27d76ffc2e7b503da9a5ecf97654fc
11	11	1	2147483639	-2147483647	-9	11	a2c68c4b2bd3c6496dbb950de07549b99f586464
12	12	2	2147483640	-2147483646	-8	12	8f03472cce5280aba1d0a4f1bf42b984f063dfc6
13	13	3	2147483641	-2147483645	-7	13	81a05d079148374cc1ac5d995c36d3db005a7b1f
14	14	4	2147483642	-2147483644	-6	14	816a88c32835139a3c1b8362020241a7d03c1768
15	15	5	2147483643	-2147483643	-5	15	66e995d4929bcd5d21e7ad0e00b8203ddba9c9c4
16	16	6	2147483644	-2147483642	-4	16	2f783ca2ead824631f7b729cfcf1cf22748aa2b7
17	17	7	2147483645	-2147483641	-3	17	9fe20fbc5f880a060075656835cdf38e2b2cefcd
18	18	8	2147483646	-2147483640	-2	18	c8abcc9e265f63f0fe47931bfeb1328e57a6e848
19	19	9	2147483647	-2147483639	-1	19	c36cdf290b4883026e80a0aa4b9156c763ae2a8f
Restore with key offset - 10
truncate test.t1;
select kiu, kis, diu_low, diu_hi, dis_low, dis_hi, d, sha1(t) from test.t1 order by kiu;
kiu	kis	diu_low	diu_hi	dis_low	dis_hi	d	sha1(t)
0	0	0	4294967286	-2147483648	2147483638	10	1746a73fbc27d76ffc2e7b503da9a5ecf97654fc
1	1	1	4294967287	-2147483647	2147483639	11	a2c68c4b2bd3c6496dbb950de07549b99f586464
2	2	2	4294967288	-2147483646	2147483640	12	8f03472cce5280aba1d0a4f1bf42b984f063dfc6
3	3	3	4294967289	-2147483645	2147483641	13	81a05d079148374cc1ac5d995c36d3db005a7b1f
4	4	4	4294967290	-2147483644	2147483642	14	816a88c32835139a3c1b8362020241a7d03c1768
5	5	5	4294967291	-2147483643	2147483643	15	66e995d4929bcd5d21e7ad0e00b8203ddba9c9c4
6	6	6	4294967292	-2147483642	2147483644	16	2f783ca2ead824631f7b729cfcf1cf22748aa2b7
7	7	7	4294967293	-2147483641	2147483645	17	9fe20fbc5f880a060075656835cdf38e2b2cefcd
8	8	8	4294967294	-2147483640	2147483646	18	c8abcc9e265f63f0fe47931bfeb1328e57a6e848
9	9	9	4294967295	-2147483639	2147483647	19	c36cdf290b4883026e80a0aa4b9156c763ae2a8f
Restore with max positive key offset kiu + 2147483647 kis + 2147483647-19
truncate test.t1;
select kiu, kis, diu_low, diu_hi, dis_low, dis_hi, d, sha1(t) from test.t1 order by kiu;
kiu	kis	diu_low	diu_hi	dis_low	dis_hi	d	sha1(t)
2147483657	2147483638	0	4294967286	-2147483648	2147483638	10	1746a73fbc27d76ffc2e7b503da9a5ecf97654fc
2147483658	2147483639	1	4294967287	-2147483647	2147483639	11	a2c68c4b2bd3c6496dbb950de07549b99f586464
2147483659	2147483640	2	4294967288	-2147483646	2147483640	12	8f03472cce5280aba1d0a4f1bf42b984f063dfc6
2147483660	2147483641	3	4294967289	-2147483645	2147483641	13	81a05d079148374cc1ac5d995c36d3db005a7b1f
2147483661	2147483642	4	4294967290	-2147483644	2147483642	14	816a88c32835139a3c1b8362020241a7d03c1768
2147483662	2147483643	5	4294967291	-2147483643	2147483643	15	66e995d4929bcd5d21e7ad0e00b8203ddba9c9c4
2147483663	2147483644	6	4294967292	-2147483642	2147483644	16	2f783ca2ead824631f7b729cfcf1cf22748aa2b7
2147483664	2147483645	7	4294967293	-2147483641	2147483645	17	9fe20fbc5f880a060075656835cdf38e2b2cefcd
2147483665	2147483646	8	4294967294	-2147483640	2147483646	18	c8abcc9e265f63f0fe47931bfeb1328e57a6e848
2147483666	2147483647	9	4294967295	-2147483639	2147483647	19	c36cdf290b4883026e80a0aa4b9156c763ae2a8f
Restore with max negative key offset kiu -10 kis -2147483648
truncate test.t1;
select kiu, kis, diu_low, diu_hi, dis_low, dis_hi, d, sha1(t) from test.t1 order by kiu;
kiu	kis	diu_low	diu_hi	dis_low	dis_hi	d	sha1(t)
0	-2147483638	0	4294967286	-2147483648	2147483638	10	1746a73fbc27d76ffc2e7b503da9a5ecf97654fc
1	-2147483637	1	4294967287	-2147483647	2147483639	11	a2c68c4b2bd3c6496dbb950de07549b99f586464
2	-2147483636	2	4294967288	-2147483646	2147483640	12	8f03472cce5280aba1d0a4f1bf42b984f063dfc6
3	-2147483635	3	4294967289	-2147483645	2147483641	13	81a05d079148374cc1ac5d995c36d3db005a7b1f
4	-2147483634	4	4294967290	-2147483644	2147483642	14	816a88c32835139a3c1b8362020241a7d03c1768
5	-2147483633	5	4294967291	-2147483643	2147483643	15	66e995d4929bcd5d21e7ad0e00b8203ddba9c9c4
6	-2147483632	6	4294967292	-2147483642	2147483644	16	2f783ca2ead824631f7b729cfcf1cf22748aa2b7
7	-2147483631	7	4294967293	-2147483641	2147483645	17	9fe20fbc5f880a060075656835cdf38e2b2cefcd
8	-2147483630	8	4294967294	-2147483640	2147483646	18	c8abcc9e265f63f0fe47931bfeb1328e57a6e848
9	-2147483629	9	4294967295	-2147483639	2147483647	19	c36cdf290b4883026e80a0aa4b9156c763ae2a8f
drop table test.t1;
