# Top-level coverage tests for ST_HausdorffDistance function.

# NULL handling
SELECT ST_HausdorffDistance(NULL,NULL);
SELECT ST_HausdorffDistance(NULL,'');

# Test error wrong number of arguments.
--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
DO ST_HausdorffDistance('LINESTRING(0 0, 0 1)');

# Test error forwarding from geometry parsing.
--error ER_GIS_INVALID_DATA
DO ST_HausdorffDistance('','');

--error ER_SRS_NOT_FOUND
SELECT st_hausdorffdistance(0xffffffff01020000000500000000000000000000000000000000000000000000000000F03F000000000000F03F000000000000F03F00000000000000400000000000000040000000000000F03F00000000000000400000000000000040,0xffffffff01020000000500000000000000000000000000000000000000000000000000F03F000000000000F03F000000000000F03F00000000000000400000000000000040000000000000F03F00000000000000400000000000000040);

--error ER_GIS_DIFFERENT_SRIDS
DO ST_HausdorffDistance
(ST_GEOMFROMTEXT('LINESTRING(0 0,1 1,2 1,1 2,2 2)', 4326),
 ST_GEOMFROMTEXT('LINESTRING(0 1,1 0,1 1,1 2,1 3)', 0));

# Test error on unsupported types.
# there are no unsupported types

# Test error on not implemented types.
--error ER_NOT_IMPLEMENTED_FOR_CARTESIAN_SRS
DO ST_HausdorffDistance(ST_GEOMFROMTEXT('POINT(0 0)'), ST_GEOMFROMTEXT('POINT(0 1)'));
--error ER_NOT_IMPLEMENTED_FOR_CARTESIAN_SRS
DO ST_HausdorffDistance(ST_GEOMFROMTEXT('LINESTRING(0 0, 0 1)'), ST_GEOMFROMTEXT('MULTIPOINT(0 1)'));
--error ER_NOT_IMPLEMENTED_FOR_CARTESIAN_SRS
DO ST_HausdorffDistance(ST_GEOMFROMTEXT('LINESTRING(0 0, 0 1)'), ST_GEOMFROMTEXT('POLYGON((0 0, 1 0, 1 1, 0 0))'));
--error ER_NOT_IMPLEMENTED_FOR_CARTESIAN_SRS
DO ST_HausdorffDistance(ST_GEOMFROMTEXT('LINESTRING(0 0, 0 1)'), ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0, 1 0, 1 1, 0 0)))'));
--error ER_NOT_IMPLEMENTED_FOR_GEOGRAPHIC_SRS
DO ST_HausdorffDistance(ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0, 1 0, 1 1, 0 0)))', 4326), ST_GEOMFROMTEXT('LINESTRING(0 0, 0 1)', 4326));
--error ER_NOT_IMPLEMENTED_FOR_CARTESIAN_SRS
DO ST_HausdorffDistance(ST_GEOMFROMTEXT('LINESTRING(0 0, 0 1)'), ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(LINESTRING(0 0, 0 1))'));
--error ER_NOT_IMPLEMENTED_FOR_CARTESIAN_SRS
DO ST_HausdorffDistance(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(LINESTRING(0 0, 0 1))'), ST_GEOMFROMTEXT('LINESTRING(0 0, 0 1)'));
--error ER_NOT_IMPLEMENTED_FOR_GEOGRAPHIC_SRS
DO ST_HausdorffDistance(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(LINESTRING(0 0, 0 1))', 4326), ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(LINESTRING(0 0, 0 1))', 4326));


# Test error due to numeric overflow.
--error ER_DATA_OUT_OF_RANGE
DO ST_HausdorffDistance(ST_GEOMFROMTEXT('LINESTRING(0 0, 0 1e308, 1e308 1e308)'), ST_GEOMFROMTEXT('LINESTRING(0 0, 0 1)'));


# Excercise code on supported types.
# Cartesian
SELECT
  ROUND(
    ST_HausdorffDistance
       (ST_GEOMFROMTEXT('LINESTRING(0 0, 100 0)', 0),
        ST_GEOMFROMTEXT('LINESTRING(0 0, 50 50, 100 0)', 0)),
    2
  ) AS dfd;

# Geographic
SELECT
  ROUND(
    ST_HausdorffDistance
       (ST_GEOMFROMTEXT('LINESTRING(0 0,1 1,2 1,1 2,2 2)', 4326),
        ST_GEOMFROMTEXT('LINESTRING(0 1,1 0,1 1,1 2,1 3)', 4326),
        'foot'),
    2
  ) AS dfd;

# End of top-level coverage test.
