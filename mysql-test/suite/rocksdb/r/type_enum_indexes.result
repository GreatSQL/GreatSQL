SET @ORIG_PAUSE_BACKGROUND_WORK = @@ROCKSDB_PAUSE_BACKGROUND_WORK;
SET GLOBAL ROCKSDB_PAUSE_BACKGROUND_WORK = 1;
CREATE TABLE t1 (
a ENUM('N.America','S.America','Africa','Europe','Australia','Asia','Antarctica'),
b ENUM('test1','test2','test3','test4','test5'),
c ENUM('1a','1b','1d','1j','4a','4z','5a','5b','6v','6z'),
pk ENUM('1','2','3','4','5','6','7','8','9') PRIMARY KEY,
UNIQUE KEY a_b (a,b)
) ENGINE=rocksdb;
INSERT INTO t1 (a,b,c,pk) VALUES
('N.America','test1','5a',1),('Europe','test1','5b',2),('Europe','test2','6v',3),
('Africa','test3','4z',4),('Africa','test4','1j',5),('Antarctica','test4','1d',6);
SHOW INDEX IN t1;
Table	Non_unique	Key_name	Seq_in_index	Column_name	Collation	Cardinality	Sub_part	Packed	Null	Index_type	Comment	Index_comment	Visible	Expression
t1	0	PRIMARY	1	pk	A	1000	NULL	NULL		SE_SPECIFIC			YES	NULL
t1	0	a_b	1	a	A	500	NULL	NULL	YES	SE_SPECIFIC			YES	NULL
t1	0	a_b	2	b	A	1000	NULL	NULL	YES	SE_SPECIFIC			YES	NULL
EXPLAIN SELECT a FROM t1 WHERE b > 'test2' ORDER BY a;
id	select_type	table	partitions	type	possible_keys	key	key_len	ref	rows	filtered	Extra
1	SIMPLE	t1	NULL	index	NULL	a_b	4	NULL	#	#	Using where; Using index
Warnings:
Note	1003	/* select#1 */ select `test`.`t1`.`a` AS `a` from `test`.`t1` where (`test`.`t1`.`b` > 'test2') order by `test`.`t1`.`a`
SELECT a FROM t1 WHERE b > 'test2' ORDER BY a;
a
Africa
Africa
Antarctica
EXPLAIN SELECT a FROM t1 FORCE INDEX (a_b) WHERE b > 'test2' ORDER BY a;
id	select_type	table	partitions	type	possible_keys	key	key_len	ref	rows	filtered	Extra
1	SIMPLE	t1	NULL	index	NULL	a_b	4	NULL	#	#	Using where; Using index
Warnings:
Note	1003	/* select#1 */ select `test`.`t1`.`a` AS `a` from `test`.`t1` FORCE INDEX (`a_b`) where (`test`.`t1`.`b` > 'test2') order by `test`.`t1`.`a`
SELECT a FROM t1 FORCE INDEX (a_b) WHERE b > 'test2' ORDER BY a;
a
Africa
Africa
Antarctica
DROP TABLE t1;
CREATE TABLE t1 (
a ENUM('N.America','S.America','Africa','Europe','Australia','Asia','Antarctica'),
b ENUM('test1','test2','test3','test4','test5'),
c ENUM('1a','1b','1d','1j','4a','4z','5a','5b','6v','6z') PRIMARY KEY
) ENGINE=rocksdb;
INSERT INTO t1 (a,b,c) VALUES
('N.America','test1','5a'),('Europe','test1','5b'),('Europe','test2','6v'),
('Africa','test3','4z'),('Africa','test4','1j'),('Antarctica','test4','1d');
SHOW INDEX IN t1;
Table	Non_unique	Key_name	Seq_in_index	Column_name	Collation	Cardinality	Sub_part	Packed	Null	Index_type	Comment	Index_comment	Visible	Expression
t1	0	PRIMARY	1	c	A	1000	NULL	NULL		SE_SPECIFIC			YES	NULL
EXPLAIN SELECT c FROM t1 WHERE c BETWEEN '1d' AND '6u';
id	select_type	table	partitions	type	possible_keys	key	key_len	ref	rows	filtered	Extra
1	SIMPLE	t1	NULL	index	PRIMARY	PRIMARY	1	NULL	#	#	Using where; Using index
Warnings:
Note	1003	/* select#1 */ select `test`.`t1`.`c` AS `c` from `test`.`t1` where (`test`.`t1`.`c` between '1d' and '6u')
SELECT c FROM t1 WHERE c BETWEEN '1d' AND '6u';
c
1d
1j
4z
5a
5b
EXPLAIN SELECT c FROM t1 USE INDEX () WHERE c BETWEEN '1d' AND '6u';
id	select_type	table	partitions	type	possible_keys	key	key_len	ref	rows	filtered	Extra
1	SIMPLE	t1	NULL	ALL	NULL	NULL	NULL	NULL	#	#	Using where
Warnings:
Note	1003	/* select#1 */ select `test`.`t1`.`c` AS `c` from `test`.`t1` USE INDEX () where (`test`.`t1`.`c` between '1d' and '6u')
SELECT c FROM t1 USE INDEX () WHERE c BETWEEN '1d' AND '6u';
c
1d
1j
4z
5a
5b
DROP TABLE t1;
CREATE TABLE t1 (
a ENUM('N.America','S.America','Africa','Europe','Australia','Asia','Antarctica'),
b ENUM('test1','test2','test3','test4','test5'),
c ENUM('1a','1b','1d','1j','4a','4z','5a','5b','6v','6z'),
pk ENUM('1','2','3','4','5','6','7','8','9') PRIMARY KEY,
INDEX(b)
) ENGINE=rocksdb;
INSERT INTO t1 (a,b,c,pk) VALUES
('N.America','test1','5a',1),('Europe','test1','5b',2),('Europe','test2','6v',3),
('Africa','test3','4z',4),('Africa','test4','1j',5),('Antarctica','test4','1d',6);
SHOW INDEX IN t1;
Table	Non_unique	Key_name	Seq_in_index	Column_name	Collation	Cardinality	Sub_part	Packed	Null	Index_type	Comment	Index_comment	Visible	Expression
t1	0	PRIMARY	1	pk	A	1000	NULL	NULL		SE_SPECIFIC			YES	NULL
t1	1	b	1	b	A	500	NULL	NULL	YES	SE_SPECIFIC			YES	NULL
EXPLAIN SELECT DISTINCT b FROM t1;
id	select_type	table	partitions	type	possible_keys	key	key_len	ref	rows	filtered	Extra
1	SIMPLE	t1	NULL	range	b	b	2	NULL	#	#	Using index for group-by
Warnings:
Note	1003	/* select#1 */ select distinct `test`.`t1`.`b` AS `b` from `test`.`t1`
SELECT DISTINCT b FROM t1;
b
test1
test2
test3
test4
EXPLAIN SELECT DISTINCT b FROM t1 IGNORE INDEX (b);
id	select_type	table	partitions	type	possible_keys	key	key_len	ref	rows	filtered	Extra
1	SIMPLE	t1	NULL	ALL	NULL	NULL	NULL	NULL	#	#	Using temporary
Warnings:
Note	1003	/* select#1 */ select distinct `test`.`t1`.`b` AS `b` from `test`.`t1` IGNORE INDEX (`b`)
SELECT DISTINCT b FROM t1 IGNORE INDEX (b);
b
test1
test2
test3
test4
DROP TABLE t1;
CREATE TABLE t1 (
a ENUM('N.America','S.America','Africa','Europe','Australia','Asia','Antarctica'),
b ENUM('test1','test2','test3','test4','test5'),
c ENUM('1a','1b','1d','1j','4a','4z','5a','5b','6v','6z'),
d ENUM('1a','1b','1d','1j','4a','4z','5a','5b','6v','6z'),
pk ENUM('1','2','3','4','5','6','7','8','9') PRIMARY KEY,
key a_b_c_d(a,b,c,d)
) ENGINE=rocksdb;
INSERT INTO t1 (a,b,c,d,pk) VALUES
('N.America','test1','5a','5a',1),('Europe','test1','5b','5b',2),('Europe','test2','6v','6v',3),
('Africa','test3','4z','4z',4),('Africa','test4','1j','1j',5),('Antarctica','test4','1d','1d',6);
SHOW INDEX IN t1;
Table	Non_unique	Key_name	Seq_in_index	Column_name	Collation	Cardinality	Sub_part	Packed	Null	Index_type	Comment	Index_comment	Visible	Expression
t1	0	PRIMARY	1	pk	A	1000	NULL	NULL		SE_SPECIFIC			YES	NULL
t1	1	a_b_c_d	1	a	A	62	NULL	NULL	YES	SE_SPECIFIC			YES	NULL
t1	1	a_b_c_d	2	b	A	125	NULL	NULL	YES	SE_SPECIFIC			YES	NULL
t1	1	a_b_c_d	3	c	A	250	NULL	NULL	YES	SE_SPECIFIC			YES	NULL
t1	1	a_b_c_d	4	d	A	500	NULL	NULL	YES	SE_SPECIFIC			YES	NULL
EXPLAIN SELECT DISTINCT a,b,c,d FROM t1;
id	select_type	table	partitions	type	possible_keys	key	key_len	ref	rows	filtered	Extra
1	SIMPLE	t1	NULL	index	a_b_c_d	a_b_c_d	8	NULL	#	#	Using index
Warnings:
Note	1003	/* select#1 */ select distinct `test`.`t1`.`a` AS `a`,`test`.`t1`.`b` AS `b`,`test`.`t1`.`c` AS `c`,`test`.`t1`.`d` AS `d` from `test`.`t1`
SELECT DISTINCT a,b,c,d FROM t1;
a	b	c	d
Africa	test3	4z	4z
Africa	test4	1j	1j
Antarctica	test4	1d	1d
Europe	test1	5b	5b
Europe	test2	6v	6v
N.America	test1	5a	5a
DROP TABLE t1;
SET GLOBAL ROCKSDB_PAUSE_BACKGROUND_WORK = @ORIG_PAUSE_BACKGROUND_WORK;
